# Wiznotes_tools 为知笔记批量操作脚本

## **clipboard_wxnotes_yagmail_wiz:** 从剪贴板文本中分离提取出微信公众号、头条号、小红书、网页文章链接和其他内容，批量保存到为知笔记

由于微信API接口变更，现在要将微信公众号文章分享保存到为知笔记，要麻烦很多。为此我写了这个自动化脚本来提高操作效率。

我现在保存微信文章（或头条号等来源文章）的步骤如下：

1、在手机后台长期运行一个剪贴板增强app，比如：“剪纸堆”；

2、看到有意思的微信公众号文章，从菜单选择“复制链接”；

3、如果不想保存整篇文章，可以在文章中选择段落并复制；当然这一步操作不限于微信公众号文章内容，在任意阅读app上看到的文本都可以复制保存到剪贴板；

4、隔一段时间（比如一周），在“剪纸堆”app将所有在后台保存的剪贴板内容聚合并导出为文本文件；

5、运行该自动化脚本，将自动提取文本中微信公众号文章链接，通过发送邮件方式将所有文章批量保存到为知笔记；其余非微信链接内容合并后单独保存到为知笔记；

![1](./image/1.png)

**clipboard_wxnotes_yagmail_wiz（新）:** 借助yagmail模块重写脚本，直接从系统剪贴板提取内容并发送到为知笔记，更简洁更方便

**wxnotes_mail_wiz.py:（旧）** 从文本文件中提取微信公众号文章链接，批量保存到为知笔记


## **wiz2md.py:** 批量导出为知笔记.md.ziw文件为标准markdown文件

为知笔记只支持逐个笔记导出为markdown文件，此脚本可以从老版为知笔记数据文件夹自动搜索markdown方式记录的笔记文件，并批量导出为标准markdown文件。


## **pic_yagmail_wiz:** 将图片和对应OCR文本批量发送到为知笔记

我有时会将手机上看到的有意思的内容截图保存，但问题就是后续无法通过搜索来找到相关截图。印象笔记支持搜索图片文字，为知笔记不支持。

于是，我就先用百度AI OCR服务将截图文件批量识别成文本，然后再用这个脚本将截图和对应OCR文本批量发送到为知笔记，自动生成一个笔记。这样就可以通过文字方式搜索了。截图保存下来的内容，后续也不至于石沉大海，可以在有需要时检索回顾了。

![2](./image/2.png)


**check_undone_imgs.py:** 找到未成功发送到为知笔记的文件，重新移入待处理文件夹

我历史积累了数千张图文件，通过批量发邮件方式保存到为知笔记，由于邮箱服务商会对每日发送邮件数量做限制，所以有些邮件好像发送成功，实际未发出去。因此，我写了这个脚本来检查哪些其实没发送成功，隔日再重新发送。


## **get_wiz_notes.py:** 通过Web API批量导出为知笔记

由于为知笔记官方客户端不支持批量导出功能，此脚本通过调用为知笔记Web API实现批量导出笔记（支持导出图片及附件）。

**主要功能**
- 支持按文件夹批量导出笔记
- 自动识别笔记类型并导出为对应格式（markdown/html）
- 支持断点续传，可随时中断后继续导出
- 详细的日志记录，方便追踪导出过程

**使用方法**
在 account/web_accounts.json 中配置为知笔记账号信息。